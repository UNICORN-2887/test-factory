[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=4e05a01d-59e7-49de-a725-d5dc3557c47a
Description=时空迷雾
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Global HD1,HD2,HD3//定义全局句柄
Sub Handle
    Dim Hwnd, HwndEx1, HwndEx2
    Hwnd = Plugin.Window.Find("Qt5156QWindowIcon", "MuMu模拟器12")
    HD1 = Hwnd
    HwndEx1 = Plugin.Window.FindEx(Hwnd, 0, "Qt5156QWindowIcon", "MuMuPlayer")
    HD2 = HwndEx1
    HwndEx2 = Plugin.Window.FindEx(HwndEx1, 0, "nemuwin", "nemudisplay")
    HD3 = HwndEx2
    Form1.ListBox1.AddItem Hwnd
    Form1.ListBox1.AddItem HwndEx1
    Form1.ListBox1.AddItem HwndEx2
    //	MsgBox HD1
    //	MsgBox HD2
    //	MsgBox HD3
    //改变窗口大小为(1920, 1080)
End Sub
Sub HP
    Call Plugin.Window.Size(HD1, 2560, 1440)
End Sub
//671 561
Call Handle
Call HP
XYs8 = Plugin.Bkgnd.FindPic(HD1, 1811, 1234, 1856, 1269, "D:\工程\项目图片\7d\迷雾-无次数1.bmp", 0, 0.6)//出现0
		iZBs8 = InStr(XYs8, "|")
		Xs8 = CLng(Left(XYs8, iZBs8 - 1))
		Ys8 = CLng(Right(XYs8, Len(XYs8) - iZBs8))
		If Xs8 <> - 1  Then 
			MsgBox "find"
		End if
ExitScript

ExitScript
call 心愿任务锁死
ExitScript
Call 滑动(0, 900, 500, 200, 500, 1000)//右滑
Call 滑动(0, 200, 500, 900, 500, 1000)//左滑
Call 滑动(0, 500, 600, 500, 300, 1000)//下滑
//Call Module(1)
ExitScript 
Event Form1.test.Click
Call Handle
Call HP
Call 时空迷雾战斗
End Event

Sub 心愿任务锁死
Do
	Do
	XY = Plugin.Bkgnd.FindPic(HD1, 600, 567, 1049, 767, "D:\工程\项目图片\7d\心愿任务锁死.bmp", 0, 0.9)
	iZB = InStr(XY, "|")
	X = CLng(Left(XY, iZB - 1))
	Y = CLng(Right(XY, Len(XY) - iZB))
	Delay 800
	Loop Until X <> - 1 
	
	PauseThread Main
	
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 727, 715)//点击取消
	Delay 1000
	
	ContinueThread Main
Loop
End Sub






















//Call ttt
Event Form1.Button2.Click
Call Handle
Call HP
//ExitScript
call 时空迷雾

ExitScript
End Event

Sub 时空迷雾
	Dim dft//记录难度
	dft = 0
	
	Rem Redo
	
	Do
	bXY9 = Plugin.Bkgnd.FindColorEx(HD1, 1611, 230, 1623, 244, "FBFFA2", 0, 0.9)//检测欧柏加号
	bZB9 = InStr(bXY9, "|")
	//TracePrint "looping"
	bX9 = Clng(Left(bXY9, bZB9 - 1)) : bY9 = Clng(Right(bXY9, Len(bXY9) - bZB9))
	Loop Until bX9 <> - 1 //确认返回都市
	
	Delay 1000
	//MsgBox "in"
	//Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 1585, 978)//点击地图
	Delay 3000
	Do
	XYp = Plugin.Bkgnd.FindColorEx(HD1, 150, 572, 159, 584, "FEFFBA", 0, 0.9)//查看是否进来
	ZBp = InStr(XYp, "|")
	Xp = Clng(Left(XYp, ZBp - 1)): Yp = Clng(Right(XYp, Len(XYp) - ZBp))
	Loop Until Xp <> - 1 
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 152, 674)//点击挑战
	Delay 1000
	//MsgBox "in1"
	Do
	XYp1 = Plugin.Bkgnd.FindColorEx(HD1, 732, 851, 776, 893, "97167D", 0, 0.8)//查看是否切换成功
	ZBp1 = InStr(XYp1, "|")
	Xp1 = Clng(Left(XYp1, ZBp1 - 1)) : Yp1 = Clng(Right(XYp1, Len(XYp1) - ZBp1))
	Loop Until Xp1 <> - 1 
	Delay 2000
	
	XYpt = Plugin.Bkgnd.FindPic(HD1, 523, 877, 621, 974, "D:\工程\项目图片\7d\时空迷雾-剩余次数.bmp", 0, 0.9)//剩余次数
	iZBpt = InStr(XYpt, "|")
	Xpt = CLng(Left(XYpt, iZBpt - 1))
	Ypt = CLng(Right(XYpt, Len(XYpt) - iZBpt))
	If Xpt = - 1  Then //剩余次数没有了
		MsgBox "drop out"
		Delay 1000
		Goto ExMi
	End If

//	
//	XYpt = Plugin.Bkgnd.FindColorEx(HD1, 553, 906, 586, 940, "BBE3FF", 0, 0.9)//查看是否打勾
//	ZBpt = InStr(XYpt, "|")
//	Xpt = Clng(Left(XYpt, ZBpt - 1)) : Ypt = Clng(Right(XYpt, Len(XYpt) - ZBpt))
//	If Xpt <> - 1  Then 
//		MsgBox "drop in"
//		Delay 1000
//		Goto ExMi
//	End If
	
	Call Plugin.Bkgnd.LeftClick(HD2, 467, 703)//点击时空迷雾
	
	Do
	XYs1 = Plugin.Bkgnd.FindColorEx(HD1, 760, 489, 804, 533, "FCFFA3", 0, 0.9)//检测加号 应光缆
	ZBs1 = InStr(XYs1, "|")
	Xs1 = Clng(Left(XYs1, ZBs1 - 1)) : Ys1 = Clng(Right(XYs1, Len(XYs1) - ZBs1))
	Loop Until Xs1 <> - 1
	Delay 1000

	Call Plugin.Bkgnd.LeftClick(HD2, 686, 312)//点击下拉
	Delay 1000
	
	//选择难度
	If dft = 0 Then //如果dft=0则没有选择难度 右值证明是推出来的
	
		Call Plugin.Bkgnd.LeftClick(HD2, 427, 552)//点击地狱
		Delay 1000
		Call Plugin.Bkgnd.LeftClick(HD2, 1641, 968)//点击寻找队伍
		Delay 3000
		XYs2 = Plugin.Bkgnd.FindPic(HD1, 301, 1127, 529, 1239, "D:\工程\项目图片\7d\时空迷雾-刷新.bmp", 0, 0.9)//pass
		iZBs2 = InStr(XYs2, "|")
		Xs2 = CLng(Left(XYs2, iZBs2 - 1))
		Ys2 = CLng(Right(XYs2, Len(XYs2) - iZBs2))
	
		If Xs2 = - 1  Then 
			Delay 1500
			Call Plugin.Bkgnd.LeftClick(HD2, 686, 312)//点击下拉
			Delay 1000
			
			Call Plugin.Bkgnd.LeftClick(HD2, 426, 489)//点击噩梦
			Delay 1000
			Call Plugin.Bkgnd.LeftClick(HD2, 1641, 968)//点击寻找队伍
			Delay 3000
			XYs3 = Plugin.Bkgnd.FindPic(HD1, 301, 1127, 529, 1239, "D:\工程\项目图片\7d\时空迷雾-刷新.bmp", 0, 0.9)
			iZBs3 = InStr(XYs3, "|")
			Xs3 = CLng(Left(XYs3, iZBs3 - 1))
			Ys3 = CLng(Right(XYs3, Len(XYs3) - iZBs3))
			
			If Xs3 = - 1  Then 
				Delay 1500
				Call Plugin.Bkgnd.LeftClick(HD2, 686, 312)//点击下拉
				Delay 1000
				
				Call Plugin.Bkgnd.LeftClick(HD2, 429, 428)//点击困难
				Delay 1000
				Call Plugin.Bkgnd.LeftClick(HD2, 1641, 968)//点击寻找队伍
				Delay 3000
				XYs4 = Plugin.Bkgnd.FindPic(HD1, 301, 1127, 529, 1239, "D:\工程\项目图片\7d\时空迷雾-刷新.bmp", 0, 0.9)
				iZBs4 = InStr(XYs4, "|")
				Xs4 = CLng(Left(XYs4, iZBs4 - 1))
				Ys4 = CLng(Right(XYs4, Len(XYs4) - iZBs4))
				
				If Xs4 = - 1  Then 
					dft = 1
					Delay 1500
					Call Plugin.Bkgnd.LeftClick(HD2, 686, 312)//点击下拉
					Delay 1000
					
					Call Plugin.Bkgnd.LeftClick(HD2, 433, 374)//点击简单
					Delay 1000
					Call Plugin.Bkgnd.LeftClick(HD2, 1641, 968)//点击寻找队伍
					Delay 3000
					Do
					XYs5 = Plugin.Bkgnd.FindPic(HD1, 301, 1127, 529, 1239, "D:\工程\项目图片\7d\时空迷雾-刷新.bmp", 0, 0.9)
					iZBs5 = InStr(XYs5, "|")
					Xs5 = CLng(Left(XYs5, iZBs5 - 1))
					Ys5 = CLng(Right(XYs5, Len(XYs5) - iZBs5))
					Loop Until Xs5 <> - 1 
				Else 
					dft = 2
				End If
			Else 
				dft = 3
			End If
		Else 
			dft = 4
		End If
	Else 
		Delay 1000
		Select Case dft
			Case 1
				Call Plugin.Bkgnd.LeftClick(HD2, 436, 374)//点击普通
				Delay 1000
			Case 2
				Call Plugin.Bkgnd.LeftClick(HD2, 436, 434)//点击困难
				Delay 1000
			Case 3
				Call Plugin.Bkgnd.LeftClick(HD2, 436, 493)//点击噩梦
				Delay 1000
			Case 4
				Call Plugin.Bkgnd.LeftClick(HD2, 436, 546)//点击地狱
				Delay 1000
		End Select
		Call Plugin.Bkgnd.LeftClick(HD2, 1641, 968)//点击寻找队伍
	End If
	Delay 1500
	
	Call Plugin.Bkgnd.LeftClick(HD2, 1772, 980)//点击快速匹配
	Delay 1500
	Do
	XYs6 = Plugin.Bkgnd.FindColorEx(HD1, 1601, 1099, 1659, 1140, "413EF0", 0, 0.95)//等待到右红色的准备界面
	ZBs6 = InStr(XYs6, "|")
	Xs6 = Clng(Left(XYs6, ZBs6 - 1)) : Ys6 = Clng(Right(XYs6, Len(XYs6) - ZBs6))
	Loop Until Xs6 <> - 1 
	
	//MsgBox "准备"
	Delay 1000
	//选角色
	Call Plugin.Bkgnd.LeftClick(HD2, 468, 968)//点击选择角色
	Delay 1700
	
	Call Plugin.Bkgnd.LeftClick(HD2, 293, 983)//点击第一角色
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 443, 1015-200)//替换第一角色伪
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 293, 983)//点击第一角色
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 409, 295)//替换第一角色
	Delay 500
	
	Call Plugin.Bkgnd.LeftClick(HD2, 488, 986)//点击第二角色
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 674, 1021-200)//替换第2角色伪
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 488, 986)//点击第2角色
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 697, 313)//替换第二角色
	Delay 500
	
	Call Plugin.Bkgnd.LeftClick(HD2, 672, 984)//点击第三角色
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 910, 1010-200)//替换第3角色伪
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 672, 984)//点击第3角色
	Delay 500
	Call Plugin.Bkgnd.LeftClick(HD2, 910, 332)//替换第三角色
	Delay 1000
	
	Call Plugin.Bkgnd.LeftClick(HD2, 1690, 968)//点击返回
	
	//点击准备
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 1693, 933)//点击准备
	//MsgBox "准备i战斗"
	Delay 5000
	Dim StateF
	StateF = 0
	StateF = 时空迷雾战斗()
	
	If StateF = 1 Then 
		//MsgBox "victory"
		Do
		XYf6 = Plugin.Bkgnd.FindPic(HD1, 812, 1103, 1136, 1209, "D:\工程\项目图片\7d\时空迷雾-战斗胜利.bmp", 0, 0.7)//战斗胜利 pass
		iZBf6 = InStr(XYf6, "|")
		Xf6 = CLng(Left(XYf6, iZBf6 - 1))
		Yf6 = CLng(Right(XYf6, Len(XYf6) - iZBf6))
		Loop Until Xf6 <> - 1 
		//MsgBox "找到 跳过字样"
		
		Delay 2000
		Call Plugin.Bkgnd.LeftClick(HD2, 962, 954)//点击跳过
		Delay 3000
		
		Call Plugin.Bkgnd.LeftClick(HD2, 955, 997)//点击任意一处返回？？
		
		Delay 7000

		Do
		//可能返回都市或再匹配界面
		XYs7 = Plugin.Bkgnd.FindPic(HD1, 1612, 1119, 1842, 1201, "D:\工程\项目图片\7d\时空迷雾-胜利匹配.bmp", 0, 0.9)//等到匹配出现 pass
		iZBs7 = InStr(XYs7, "|")
		Xs7 = CLng(Left(XYs7, iZBs7 - 1))
		Ys7 = CLng(Right(XYs7, Len(XYs7) - iZBs7))
		
		aXY9 = Plugin.Bkgnd.FindColorEx(HD1, 1611, 230, 1623, 244, "FBFFA2", 0, 0.9)//检测欧柏加号
		aZB9 = InStr(aXY9, "|")
		aX9 = Clng(Left(aXY9, aZB9 - 1)) : aY9 = Clng(Right(aXY9, Len(aXY9) - aZB9))
		Delay 800
		Loop Until Xs7 <> - 1  or aX9 <> - 1 
		
		If aX9 <> - 1  Then //如果退回到主页面
			Delay 1000
			Goto Redo
		End If
		
		Delay 1000
		
		Dim Xs8
		Xs8 = -1
		//检测剩余次数 循环检测20s 0/10图片
		For 1000
		XYn1 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数.bmp", 0, 0.8)
		iZBn1 = InStr(XYn1, "|")
		Xn1 = CLng(Left(XYn1, iZBn1 - 1))
		Yn1 = CLng(Right(XYn1, Len(XYn1) - iZBn1))
		
		XYn2 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数1.bmp", 0, 0.8)
		iZBn2 = InStr(XYn2, "|")
		Xn2 = CLng(Left(XYn2, iZBn2 - 1))
		Yn2 = CLng(Right(XYn2, Len(XYn2) - iZBn2))
		
		XYn3 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数2.bmp", 0, 0.8)
		iZBn3 = InStr(XYn3, "|")
		Xn3 = CLng(Left(XYn3, iZBn3 - 1))
		Yn3 = CLng(Right(XYn3, Len(XYn3) - iZBn3))
		
		XYn4 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数3.bmp", 0, 0.8)
		iZBn4 = InStr(XYn4, "|")
		Xn4 = CLng(Left(XYn4, iZBn4 - 1))
		Yn4 = CLng(Right(XYn4, Len(XYn4) - iZBn4))
		
		XYn5 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数4.bmp", 0, 0.8)
		iZBn5 = InStr(XYn5, "|")
		Xn5 = CLng(Left(XYn5, iZBn5 - 1))
		Yn5 = CLng(Right(XYn5, Len(XYn5) - iZBn5))
		
		XYn6 = Plugin.Bkgnd.FindPic(HD1, 1758, 1212, 1876, 1290, "D:\工程\项目图片\7d\迷雾-无次数5.bmp", 0, 0.8)
		iZBn6 = InStr(XYn6, "|")
		Xn6 = CLng(Left(XYn6, iZBn6 - 1))
		Yn6 = CLng(Right(XYn6, Len(XYn6) - iZBn6))
		If Xn1 <> - 1  or Xn2 <> - 1  or Xn3 <> - 1  or Xn4 <> - 1  or Xn5 <> - 1  or Xn6 <> - 1  Then 
			Xs8 = 1
			Goto K
		End if
		Delay 20
		Next
		//如果Xs8 为一则证明已经打完了
		Rem K
		
		If Xs8 <> - 1  Then 
			Delay 1000
			Call Plugin.Bkgnd.LeftClick(HD2, 102, 32)//点击回退箭头
			Delay 1000
			Do
			XYs10 = Plugin.Bkgnd.FindColorEx(HD1, 853, 866, 896, 909, "C0C778", 0, 0.9)//是否退出队伍
			ZBs10 = InStr(XYs10, "|")
			Xs10 = Clng(Left(XYs10, ZBs10 - 1)): Ys10 = Clng(Right(XYs10, Len(XYs10) - ZBs10))
			Loop Until Xs10 <> - 1 
			Delay 1000
			Call Plugin.Bkgnd.LeftClick(HD2, 1206, 710)//点击确定
			Delay 1000
			Do
			XYs11 = Plugin.Bkgnd.FindColorEx(HD1, 1402, 212, 1441, 253, "E343DF", 0, 0.9)//回到乱流界面
			ZBs11 = InStr(XYs11, "|")
			Xs11 = Clng(Left(XYs11, ZBs11 - 1)): Ys11 = Clng(Right(XYs11, Len(XYs11) - ZBs11))
			Loop Until Xs11 <> - 1 
			Delay 1000
			Call Plugin.Bkgnd.LeftClick(HD2, 102, 32)//点击回退箭头
			Delay 1000
			
			Goto ExMi
		End If
		
		Delay 2000
		Call Plugin.Bkgnd.LeftClick(HD2, 1705, 975)//点击匹配
	Else 
		//MsgBox "时空迷雾结束"
	End If
	
	Rem ExMi
	Delay 1000
	Do
	XYs12 = Plugin.Bkgnd.FindColorEx(HD1, 452, 984, 484, 1008, "8BDFFF", 0, 0.9)//回到挑战界面
	ZBs12 = InStr(XYs12, "|")
	Xs12 = Clng(Left(XYs12, ZBs12 - 1)) : Ys12 = Clng(Right(XYs12, Len(XYs12) - ZBs12))
	Loop Until Xs12 <> -1

	MsgBox "时空迷雾结束"
	//812, 1103  1136, 1209 战斗胜利范围
End Sub




//	Delay 1500
//	Do
//	XYs6 = Plugin.Bkgnd.FindColorEx(HD1, 1601, 1099, 1659, 1140, "413EF0", 0, 0.95)//等待到右红色的准备界面
//	ZBs6 = InStr(XYs6, "|")
//	Xs6 = Clng(Left(XYs6, ZBs6 - 1)) : Ys6 = Clng(Right(XYs6, Len(XYs6) - ZBs6))
//	Loop Until Xs6 <> - 1 
//	Delay 200
//	Call Plugin.Bkgnd.LeftClick(HD2, 147, 972)//点击取消匹配
//	Delay 1000
//	Call Plugin.Bkgnd.LeftClick(HD2, 147, 972)//同样位置点击更改上阵
//	Delay 1500
//	Call Plugin.Bkgnd.LeftClick(HD2, 423, 311)//点击第一角色
//	Delay 1500
//	Call Plugin.Bkgnd.LeftClick(HD2, 1704, 1024)//点击确认
//	Delay 1000
//	Call Plugin.Bkgnd.LeftClick(HD2, 1693, 933)//点击匹配
//	//MsgBox "准备i战斗"
//	Delay 7000















Event Form1.Button1.Click
	Call Handle
Call HP

		Dim Index  
    	Index = Split(Form1.ComboBox1.List,"|")   
		TracePrint Index(Form1.ComboBox1.ListIndex)
		
		Dim 路径
		路径 = "D:\工程\项目图片\7d\" & Index(Form1.ComboBox1.ListIndex) & ".bmp"
		TracePrint 路径
		
		XY = Plugin.Bkgnd.FindPic(HD1, 364, 406, 776, 603, 路径, 0, 0.9)
		iZB = InStr(XY, "|")
		X = CLng(Left(XY, iZB - 1))
		Y = CLng(Right(XY, Len(XY) - iZB))
		MsgBox X & " " & Y
		ExitScript
End Event
 
Function 滑动(Code, X1, Y1, X2, Y2, S)
    X1 = X1 + 150: Y1 = Y1 +150: X2 = X2 + 150: Y2 = Y2 +150
    命令 = "shell input swipe " & X1 & " " & Y1 & " " & X2 & " " & Y2 & " " & S
    命令 = """" & 命令 & """"
    TracePrint 命令

    //Call ExtractPathSimplified
    //路径 = "D:&&CD " & ADR2
    //D:\MuMu Player 12\shell
    路径 = "D:&&CD D:\工程\MuMu Player 12\shell"
    命令行 = 路径 & "&&MuMuManager.exe adb -v " & Code & " -c " & 命令
//msgbox 命令行
    TracePrint 命令行
    Plugin.SMWH.GetDOS 命令行
End Function

Function ExtractPathSimplified
	Dim LOG108
    LOG108 = "路径截取处理"
    Form1.ListBox2.AddItem LOG108
    
    Dim lastSlash 

    ' 找到最后一个反斜杠的位置
    lastSlash = InStrRev(APPROUTE, "\")
    
    ' 提取路径并去除最后一个反斜杠
    If lastSlash > 1 Then
        ADR2 = Left(APPROUTE, lastSlash - 1)
    Else
        ADR2 = APPROUTE
    End If
    
    ' 输出结果
    TracePrint ADR2
	MsgBox ADR2
    Delay 1000
End Function




Function 时空迷雾战斗
Rem 战斗
	TracePrint "start"
	//MsgBox "Start"
	Delay 1000
	//检测战斗开始 关闭战斗立绘
	Do	
	XYk = Plugin.Bkgnd.FindColorEx(HD1, 1728, 1118, 1739, 1128, "EEE9F4", 0, 0.8)//检测普通攻击交叉剑的上面的粉色
	ZBk = InStr(XYk, "|")
	Xk = Clng(Left(XYk, ZBk - 1)) : Yk = Clng(Right(XYk, Len(XYk) - ZBk))
	
	XYkk = Plugin.Bkgnd.FindColorEx(HD1, 1815, 1127, 1825, 1142, "F2E3EA", 0, 0.8)//检测普通攻击交叉剑的上面的粉色
	ZBkk = InStr(XYkk, "|")
	Xkk = Clng(Left(XYkk, ZBkk - 1)) : Ykk = Clng(Right(XYkk, Len(XYkk) - ZBkk))

	XYf = Plugin.Bkgnd.FindColorEx(HD1, 1737, 1083, 1769, 1101, "7C6ABE", 0, 0.8)//检测普通攻击交叉剑的上面的粉色
	ZBf = InStr(XYf, "|")
	Xf = Clng(Left(XYf, ZBf - 1)) : Yf = Clng(Right(XYf, Len(XYf) - ZBf))
	Loop Until Xf <> - 1  and Xk <> - 1  and Xkk <> - 1 
	
	Delay 800
	//MsgBox "testgo"
	
	//一上来就立刻检测大招情况
		GetColor1q = Plugin.Bkgnd.GetPixelColor(HD1, 1174, 1157)
		GetColor2q = Plugin.Bkgnd.GetPixelColor(HD1, 1184, 1167)
		GetColor3q = Plugin.Bkgnd.GetPixelColor(HD1, 1180, 1160)
		
		GetColor4q = Plugin.Bkgnd.GetPixelColor(HD1, 1343, 1158)
		GetColor5q = Plugin.Bkgnd.GetPixelColor(HD1, 1353, 1168)
		GetColor6q = Plugin.Bkgnd.GetPixelColor(HD1, 1347, 1162)

	Delay 200
	Call Plugin.Bkgnd.LeftClick(HD2, 1860, 74)//点击战斗设置
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 983, 632)//点击关闭立绘
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 1468, 916)//点击继续战斗
	Delay 700
	
	//自动战斗检测
	Delay 2000
	XYf1 = Plugin.Bkgnd.FindColorEx(HD1, 1652, 263, 1663, 294, "B8B468", 0, 0.9)//有没有青色 在电脑标识
	ZBf1 = InStr(XYf1, "|")
	Xf1 = Clng(Left(XYf1, ZBf1 - 1)): Yf1 = Clng(Right(XYf1, Len(XYf1) - ZBf1))
	If Xf1 <> - 1  Then //如果启动了代理
	Else 
		Call Plugin.Bkgnd.LeftClick(HD2, 1652, 71)//点击启动自动代理
		Delay 1000
	End If
	
	Dim Situation
	Situation = 1
		
	Do
		XYfa = Plugin.Bkgnd.FindPic(HD1, 980, 669, 1290, 772, "D:\工程\项目图片\7d\战斗失败.bmp", 0, 0.9)//战斗失败
		iZBfa = InStr(XYfa, "|")
		Xfa = CLng(Left(XYfa, iZBfa - 1))
		Yfa = CLng(Right(XYfa, Len(XYfa) - iZBfa))
		
		XYfb = Plugin.Bkgnd.FindPic(HD1, 1386, 1087, 1564, 1215, "D:\工程\项目图片\7d\万神殿-继续挑战.bmp", 0, 0.76)//等待到继续挑战出现 pass
		iZBfb = InStr(XYfb, "|")
		Xfb = CLng(Left(XYfb, iZBfb - 1))
		Yfb = CLng(Right(XYfb, Len(XYfb) - iZBfb))
		
		If Xfb <> - 1  or Xfa <> - 1  Then 
			//MsgBox Xfa &"|"& Yfa &"   "& Xfb &"|"& Yfb
			MsgBox "退出"
			Goto Exinner
		End If
		//检测两个次要角色的大招冷却
		Delay 1000//检测频率
		
		GetColor7q = Plugin.Bkgnd.GetPixelColor(HD1, 1174, 1157)
		GetColor8q = Plugin.Bkgnd.GetPixelColor(HD1, 1184, 1167)
		GetColor9q = Plugin.Bkgnd.GetPixelColor(HD1, 1180, 1160)
		
		GetColor10q = Plugin.Bkgnd.GetPixelColor(HD1, 1343, 1158)
		GetColor11q = Plugin.Bkgnd.GetPixelColor(HD1, 1353, 1168)
		GetColor12q = Plugin.Bkgnd.GetPixelColor(HD1, 1347, 1162)
		
		//MsgBox "大招检测 ：" & GetColor1q & " | " & GetColor7q & " ; " & GetColor2q & " | " & GetColor8q & " ; " & GetColor3q & " | " & GetColor9q & "  : " & GetColor4q & " | " & GetColor10q & "  ; " & GetColor5q & " | " & GetColor11q & " : " & GetColor6q & " | " & GetColor12q
//		MsgBox "大招检测 ："&GetColor7 & " | " & gc1&" ; "&GetColor8 & " | " & gc2&" ; "&GetColor9 & " | " & gc3&"  : "&GetColor10 & " | " & gc4&"  ; "&GetColor11 & " | " & gc5&" : "&GetColor12 & " | " & gc6
//		TracePrint GetColor7 & " | " & gc1
//		TracePrint GetColor8 & " | " & gc2
//		TracePrint GetColor9 & " | " & gc3
//		TracePrint "\n"
//		TracePrint GetColor10 & " | " & gc4
//		TracePrint GetColor11 & " | " & gc5
//		TracePrint GetColor12 & " | " & gc6

//		TracePrint "==========================="
//		TracePrint GetColor7q & " | " & GetColor1q
//		TracePrint GetColor8q & " | " & GetColor2q
//		TracePrint GetColor9q & " | " & GetColor3q
//		TracePrint "\n"
//		TracePrint GetColor10q & " | " & GetColor4q
//		TracePrint GetColor11q & " | " & GetColor5q
//		TracePrint GetColor12q & " | " & GetColor6q
//		TracePrint "==========================="
		
		If GetColor7q = GetColor1q and GetColor8q = GetColor2q and GetColor9q = GetColor3q Then 
//			TracePrint GetColor1q & " | " & GetColor7q
//			TracePrint GetColor2q & " | " & GetColor8q
//			TracePrint GetColor3q & " | " & GetColor9q
//			TracePrint "二角色开打"
			Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
			Delay 300
		End If
		If GetColor10q = GetColor4q and GetColor11q = GetColor5q and GetColor12q = GetColor6q Then 
//			TracePrint GetColor4q & " | " & GetColor10q
//			TracePrint GetColor5q & " | " & GetColor11q
//			TracePrint GetColor6q & " | " & GetColor12q
//			TracePrint "三角色开打"
			Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
			Delay 300
		End If
		
		Dim T1, T2, T3//初始化角色 1不触发
				T1 = 1
				T2 = 1
				T3 = 1
		//MsgBox Situation
		Select Case Situation
			Case 1//第一角色为主角色
				//MsgBox "first"
				Delay 800
				//血量33%
				GetColor = Plugin.Bkgnd.GetPixelColor(HD1, 21, 330)
				GetColor1 = Plugin.Bkgnd.GetPixelColor(HD1, 22, 330)
				GetColor2 = Plugin.Bkgnd.GetPixelColor(HD1, 23, 330)
				//血量50%
				GetColor3 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 369)
				GetColor4 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 370)
				GetColor5 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 371)

				//血量33%
				GetColor6 = Plugin.Bkgnd.GetPixelColor(HD1, 95, 474)
				GetColor7 = Plugin.Bkgnd.GetPixelColor(HD1, 96, 474)
				GetColor8 = Plugin.Bkgnd.GetPixelColor(HD1, 97, 474)
				//血量50%
				GetColor9 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 505)
				GetColor10 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 506)
	
				//血量33%
				GetColor11 = Plugin.Bkgnd.GetPixelColor(HD1, 30, 624)
				GetColor12 = Plugin.Bkgnd.GetPixelColor(HD1, 31, 624)
				//血量50%
				GetColor13 = Plugin.Bkgnd.GetPixelColor(HD1, 83, 655)
				GetColor14 = Plugin.Bkgnd.GetPixelColor(HD1, 84, 655)
				
				If Form1.OptionBox47.Value = 1 Then //33%血量预警
					//如果角色T1的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor = "15100F" or GetColor = "140F0E" or GetColor = "171110" or GetColor = "161010" or GetColor1 = "15100F" or GetColor1 = "140F0E" or GetColor1 = "171110" or GetColor1 = "161010" or GetColor2 = "15100F" or GetColor2 = "140F0E" or GetColor2 = "171110" or GetColor2 = "161010" Then 
						//MsgBox "T1 33%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor6 = "15100F" or GetColor6 = "140F0E" or GetColor6 = "171110" or GetColor6 = "161010" or GetColor7 = "15100F" or GetColor7 = "140F0E" or GetColor7 = "171110" or GetColor7 = "161010" or GetColor8 = "15100F" or GetColor8 = "140F0E" or GetColor8 = "171110" or GetColor8 = "161010" Then 
						//MsgBox "T2 33%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor11 = "15100F" or GetColor11 = "140F0E" or GetColor11 = "171110" or GetColor11 = "161010" or GetColor12 = "15100F" or GetColor12 = "140F0E" or GetColor12 = "171110" or GetColor12 = "161010" Then 
						//MsgBox "T3 33%"
						T3 = 0
					Else 
						T3 = 1
					End If
				ElseIf Form1.OptionBox46.Value = 1 Then//50%血量预警
					//如果角色T1的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor3 = "15100F" or GetColor3 = "140F0E" or GetColor3 = "171110" or GetColor3 = "161010" or GetColor4 = "15100F" or GetColor4 = "140F0E" or GetColor4 = "171110" or GetColor4 = "161010" or GetColor5 = "15100F" or GetColor5 = "140F0E" or GetColor5 = "171110" or GetColor5 = "161010" Then 
						MsgBox "T1 50%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor9 = "15100F" or GetColor9 = "140F0E" or GetColor9 = "171110" or GetColor9 = "161010" or GetColor10 = "15100F" or GetColor10 = "140F0E" or GetColor10 = "171110" or GetColor10 = "161010" Then 
						MsgBox "T2 50%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor13 = "15100F" or GetColor13 = "140F0E" or GetColor13 = "171110" or GetColor13 = "161010" or GetColor14 = "15100F" or GetColor14 = "140F0E" or GetColor14 = "171110" or GetColor14 = "161010" Then 
						
						T3 = 0
						MsgBox "T3 50%"&"  val: "& T3
					Else 
						T3 = 1
					End If
				End If
				
//				XYf7 = Plugin.Bkgnd.FindColorEx(HD1, 1652, 263, 1663, 294, "B8B468", 0, 0.8)//有没有青色 在电脑标识 判断战斗是否在持续
//				ZBf7 = InStr(XYf7, "|")
//				Xf7 = Clng(Left(XYf7, ZBf7 - 1)): Yf7 = Clng(Right(XYf7, Len(XYf7) - ZBf7))
//				
//				XYf8 = Plugin.Bkgnd.FindColorEx(HD1, 1737, 1083, 1769, 1101, "7C6ABE", 0, 0.97)//有没有战斗 判断战斗是否在持续
//				ZBf8 = InStr(XYf8, "|")
//				Xf8 = Clng(Left(XYf8, ZBf8 - 1)): Yf8 = Clng(Right(XYf8, Len(XYf8) - ZBf8))
				
				//TracePrint "Xf7:" & Xf7 & " ;Yf7: " & Yf7
				//TracePrint "Xf8:"&Xf8 &" ;Yf8: "&Yf8
				Xf7 = 1
				//判断战斗是否持续
				If Xf7 <> - 1  Then //在持续
					TracePrint "持续作战"
					TracePrint "T1: "&T1&" ; T2:"&T2&"  ; T3: "&T3
					If T1 = 0 Then 
						If T2 = 0 Then 
							//1危 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else
							If T3 = 0 Then //1危 2活 3危 和3换
					    		MsgBox "c with 3"
					    		Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=1
							Else //1危 2活 3活 和2换
								MsgBox "c with 2"
								Situation = 2//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T2=1
							End If
						End If
					Else 
					TracePrint "进入T2 T3"
					
						If T2 = 0 Then //1活 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else 
							If T3 = 0 Then //1活 2活 3危 和3换
								MsgBox "c with 3"
								Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=0
							End If
						End If
					End If
				End If
				
				
			Case 2
				
				
				Delay 800
				//血量33%
				GetColor15 = Plugin.Bkgnd.GetPixelColor(HD1, 34, 322)
				GetColor16 = Plugin.Bkgnd.GetPixelColor(HD1, 35, 322)
				GetColor17 = Plugin.Bkgnd.GetPixelColor(HD1, 36, 322)
				//血量50%
				GetColor18 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 354)
				GetColor19 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 355)
				GetColor20 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 356)
				TracePrint "====================================="
				TracePrint GetColor15 & " | " & GetColor16 & " | " & GetColor17
				TracePrint GetColor18 & " | " & GetColor19 & " | " & GetColor20
				TracePrint "- - - - - - - - - - - - - - - - - - -"
				//血量33%
				GetColor21 = Plugin.Bkgnd.GetPixelColor(HD1, 82, 481)
				GetColor22 = Plugin.Bkgnd.GetPixelColor(HD1, 82, 482)
				//血量50%
				GetColor23 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 520)
				GetColor24 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 521)
				GetColor25 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 522)
				TracePrint GetColor21 & " | " & GetColor22 
				TracePrint GetColor23 & " | " & GetColor24 & " | " & GetColor25
				TracePrint "- - - - - - - - - - - - - - - - - - -"
				//血量33%
				GetColor26 = Plugin.Bkgnd.GetPixelColor(HD1, 30, 624)
				GetColor27 = Plugin.Bkgnd.GetPixelColor(HD1, 31, 624)
				//血量50%
				GetColor28 = Plugin.Bkgnd.GetPixelColor(HD1, 83, 655)
				GetColor29 = Plugin.Bkgnd.GetPixelColor(HD1, 84, 655)
				
				TracePrint GetColor26 & " | " & GetColor27 
				TracePrint GetColor28 & " | " & GetColor29 
				//TracePrint GetColor 
				TracePrint "===================================="
				
				
				If Form1.OptionBox47.Value = 1 Then //33%血量预警
					//如果角色T1的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor15 = "15100F" or GetColor15 = "140F0E" or GetColor15 = "171110" or GetColor15 = "161010" or GetColor16 = "15100F" or GetColor16 = "140F0E" or GetColor16 = "171110" or GetColor16 = "161010" or GetColor17 = "15100F" or GetColor17 = "140F0E" or GetColor17 = "171110" or GetColor17 = "161010" Then 
						//MsgBox "T1 33%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor21 = "15100F" or GetColor21 = "140F0E" or GetColor21 = "171110" or GetColor21 = "161010" or GetColor22 = "15100F" or GetColor22 = "140F0E" or GetColor22 = "171110" or GetColor22 = "161010" Then 
						//MsgBox "T2 33%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor26 = "15100F" or GetColor26 = "140F0E" or GetColor26 = "171110" or GetColor26 = "161010" or GetColor27 = "15100F" or GetColor27 = "140F0E" or GetColor27 = "171110" or GetColor27 = "161010" Then 
						//MsgBox "T3 33%"
						T3 = 0
					Else 
						T3 = 1
					End If
				ElseIf Form1.OptionBox46.Value = 1 Then//50%血量预警
					//如果角色T1的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor18 = "15100F" or GetColor18 = "140F0E" or GetColor18 = "171110" or GetColor18 = "161010" or GetColor19 = "15100F" or GetColor19 = "140F0E" or GetColor19 = "171110" or GetColor19 = "161010" or GetColor20 = "15100F" or GetColor20 = "140F0E" or GetColor20 = "171110" or GetColor20 = "161010" Then 
						//MsgBox "T1 50%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor23 = "15100F" or GetColor23 = "140F0E" or GetColor23 = "171110" or GetColor23 = "161010" or GetColor24 = "15100F" or GetColor24 = "140F0E" or GetColor24 = "171110" or GetColor24 = "161010" or GetColor25 = "15100F" or GetColor25 = "140F0E" or GetColor25 = "171110" or GetColor25 = "161010"  Then 
						//MsgBox "T2 50%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor28 = "15100F" or GetColor28 = "140F0E" or GetColor28 = "171110" or GetColor28 = "161010" or GetColor29 = "15100F" or GetColor29 = "140F0E" or GetColor29 = "171110" or GetColor29 = "161010" Then 
						//MsgBox "T3 50%"
						T3 = 0
					Else 
						T3 = 1
					End If
				End If
				
//				XYf9 = Plugin.Bkgnd.FindColorEx(HD1, 1652, 263, 1663, 294, "B8B468", 0, 0.8)//有没有青色 在电脑标识 判断战斗是否在持续
//				ZBf9 = InStr(XYf9, "|")
//				Xf9 = Clng(Left(XYf9, ZBf9 - 1)): Yf9 = Clng(Right(XYf9, Len(XYf9) - ZBf9))
//				
//				XYf10 = Plugin.Bkgnd.FindColorEx(HD1, 1737, 1083, 1769, 1101, "7C6ABE", 0, 0.97)//有没有战斗 判断战斗是否在持续
//				ZBf10 = InStr(XYf10, "|")
//				Xf10 = Clng(Left(XYf10, ZBf10 - 1)): Yf10 = Clng(Right(XYf10, Len(XYf10) - ZBf10))
//				
				Xf9 = 1
				//判断战斗是否持续
				If Xf9 <> - 1  Then //在持续
					TracePrint "持续作战"
					TracePrint "T1: "&T1&" ; T2:"&T2&"  ; T3: "&T3
					If T1 = 0 Then 
						If T2 = 0 Then 
							//1危 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else
							If T3 = 0 Then //1危 2活 3危 和3换
					    		MsgBox "c with 3"
					    		Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=1
							Else //1危 2活 3活 和2换
								MsgBox "c with 2"
								Situation = 2//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T2=1
							End If
						End If
					Else 
					TracePrint "进入T2 T3"
					
						If T2 = 0 Then //1活 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else 
							If T3 = 0 Then //1活 2活 3危 和3换
								MsgBox "c with 3"
								Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=0
							End If
						End If
					End If
				End If
				
				
			Case 3
				
				
				Delay 800
				//血量33%
				GetColor30 = Plugin.Bkgnd.GetPixelColor(HD1, 34, 322)
				GetColor31 = Plugin.Bkgnd.GetPixelColor(HD1, 35, 322)
				GetColor32 = Plugin.Bkgnd.GetPixelColor(HD1, 36, 322)
				//血量50%
				GetColor33 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 354)
				GetColor34 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 355)
				GetColor35 = Plugin.Bkgnd.GetPixelColor(HD1, 88, 356)
				TracePrint "====================================="
				TracePrint GetColor30 & " | " & GetColor31 & " | " & GetColor32
				TracePrint GetColor33 & " | " & GetColor34 & " | " & GetColor35
				TracePrint "- - - - - - - - - - - - - - - - - - -"
				//血量33%
				GetColor36 = Plugin.Bkgnd.GetPixelColor(HD1, 95, 474)
				GetColor37 = Plugin.Bkgnd.GetPixelColor(HD1, 96, 474)
				GetColor38 = Plugin.Bkgnd.GetPixelColor(HD1, 97, 474)
				//血量50%
				GetColor39 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 505)
				GetColor40 = Plugin.Bkgnd.GetPixelColor(HD1, 149, 506)
				TracePrint GetColor36 & " | " & GetColor37 & " | " & GetColor38
				TracePrint GetColor39 & " | " & GetColor40
				TracePrint "- - - - - - - - - - - - - - - - - - -"
				//血量33%
				GetColor41 = Plugin.Bkgnd.GetPixelColor(HD1, 16, 631)
				GetColor42 = Plugin.Bkgnd.GetPixelColor(HD1, 17, 631)
				GetColor43 = Plugin.Bkgnd.GetPixelColor(HD1, 18, 631)
				//血量50%
				GetColor44 = Plugin.Bkgnd.GetPixelColor(HD1, 225, 659)
				GetColor45 = Plugin.Bkgnd.GetPixelColor(HD1, 255, 660)
				GetColor46 = Plugin.Bkgnd.GetPixelColor(HD1, 255, 661)
				
				TracePrint GetColor41 & " | " & GetColor42 & " | " & GetColor43
				TracePrint GetColor44 & " | " & GetColor45 & " | " & GetColor46
				//TracePrint GetColor 
				TracePrint "===================================="
				
				
				If Form1.OptionBox47.Value = 1 Then //33%血量预警
					//如果角色T1的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor30 = "15100F" or GetColor30 = "140F0E" or GetColor30 = "171110" or GetColor30 = "161010" or GetColor31 = "15100F" or GetColor31 = "140F0E" or GetColor31 = "171110" or GetColor31 = "161010" or GetColor32 = "15100F" or GetColor32 = "140F0E" or GetColor32 = "171110" or GetColor32 = "161010" Then 
						//MsgBox "T1 33%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor36 = "15100F" or GetColor36 = "140F0E" or GetColor36 = "171110" or GetColor36 = "161010" or GetColor37 = "15100F" or GetColor37 = "140F0E" or GetColor37 = "171110" or GetColor37 = "161010" or GetColor38 = "15100F" or GetColor38 = "140F0E" or GetColor38 = "171110" or GetColor38 = "161010" Then 
						//MsgBox "T2 33%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个33%监测点有任意一个出现了黑色相关色就预警
					If GetColor41 = "15100F" or GetColor41 = "140F0E" or GetColor41 = "171110" or GetColor41 = "161010" or GetColor42 = "15100F" or GetColor42 = "140F0E" or GetColor42 = "171110" or GetColor42 = "161010" or GetColor43 = "15100F" or GetColor43 = "140F0E" or GetColor43 = "171110" or GetColor43 = "161010" Then 
						//MsgBox "T3 33%"
						T3 = 0
					Else 
						T3 = 1
					End If
				ElseIf Form1.OptionBox46.Value = 1 Then//50%血量预警
					//如果角色T1的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor33 = "15100F" or GetColor33 = "140F0E" or GetColor33 = "171110" or GetColor33 = "161010" or GetColor34 = "15100F" or GetColor34 = "140F0E" or GetColor34 = "171110" or GetColor34 = "161010" or GetColor35 = "15100F" or GetColor35 = "140F0E" or GetColor35 = "171110" or GetColor35 = "161010" Then 
						//MsgBox "T1 50%"
						T1 = 0
					Else 
						T1 = 1
					End If
					//如果角色T2的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor39 = "15100F" or GetColor39 = "140F0E" or GetColor39 = "171110" or GetColor39 = "161010" or GetColor40 = "15100F" or GetColor40 = "140F0E" or GetColor40 = "171110" or GetColor40 = "161010" Then 
						//MsgBox "T2 50%"
						T2 = 0
					Else 
						T2 = 1
					End If
					//如果角色T3的三个50%监测点有任意一个出现了黑色相关色就预警
					If GetColor44 = "15100F" or GetColor44 = "140F0E" or GetColor44 = "171110" or GetColor44 = "161010" or GetColor45 = "15100F" or GetColor45 = "140F0E" or GetColor45 = "171110" or GetColor45 = "161010" or GetColor46 = "15100F" or GetColor46 = "140F0E" or GetColor46 = "171110" or GetColor46 = "161010" Then 
						//MsgBox "T3 50%"
						T3 = 0
					Else 
						T3 = 1
					End If
				End If
				
//				XYf11 = Plugin.Bkgnd.FindColorEx(HD1, 1652, 263, 1663, 294, "B8B468", 0, 0.8)//有没有青色 在电脑标识 判断战斗是否在持续
//				ZBf11 = InStr(XYf11, "|")
//				Xf11 = Clng(Left(XYf11, ZBf11 - 1)): Yf11 = Clng(Right(XYf11, Len(XYf11) - ZBf11))
//				
//				XYf12 = Plugin.Bkgnd.FindColorEx(HD1, 1737, 1083, 1769, 1101, "7C6ABE", 0, 0.97)//有没有战斗 判断战斗是否在持续
//				ZBf12 = InStr(XYf12, "|")
//				Xf12 = Clng(Left(XYf12, ZBf12 - 1)): Yf12 = Clng(Right(XYf12, Len(XYf12) - ZBf12))
				Xf11 = 1
				//判断战斗是否持续
				If Xf11 <> - 1  Then //在持续
					TracePrint "持续作战"
					TracePrint "T1: "&T1&" ; T2:"&T2&"  ; T3: "&T3
					If T1 = 0 Then 
						If T2 = 0 Then 
							//1危 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else
							If T3 = 0 Then //1危 2活 3危 和3换
					    		MsgBox "c with 3"
					    		Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=1
							Else //1危 2活 3活 和2换
								MsgBox "c with 2"
								Situation = 2//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T2=1
							End If
						End If
					Else 
					TracePrint "进入T2 T3"
					
						If T2 = 0 Then //1活 2危 和2换
							MsgBox "c with 2"
							Situation = 2//切换检测状态
							Call Plugin.Bkgnd.LeftClick(HD2, 151, 240)//切换第二角色
							Delay 500
							
							//切换角色立刻开大
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
							Delay 200
							Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
							
							T2=1
						Else 
							If T3 = 0 Then //1活 2活 3危 和3换
								MsgBox "c with 3"
								Situation = 3//切换检测状态
								Call Plugin.Bkgnd.LeftClick(HD2, 82, 388)//切换第三角色
								Delay 500
								
								//切换角色立刻开大
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1195, 970)//点击第二角色大招
								Delay 200
								Call Plugin.Bkgnd.LeftClick(HD2, 1360, 966)//点击第三角色大招
								
								T3=0
							End If
						End If
					End If
				End If
		End Select
		
		
		
		XYf5f = Plugin.Bkgnd.FindPic(HD1, 974, 696, 1390, 823, "D:\工程\项目图片\7d\神.bmp", 0, 0.7)//战斗失败 下面的实力不足红字
		iZBf5f = InStr(XYf5f, "|")
		Xf5f = CLng(Left(XYf5f, iZBf5f - 1))
		Yf5f = CLng(Right(XYf5f, Len(XYf5f) - iZBf5f))
		
		XYf6f = Plugin.Bkgnd.FindPic(HD1, 812, 1103, 1136, 1209, "D:\工程\项目图片\7d\时空迷雾-战斗胜利.bmp", 0, 0.7)//战斗胜利
		iZBf6f = InStr(XYf6f, "|")
		Xf6f = CLng(Left(XYf6f, iZBf6f - 1))
		Yf6f = CLng(Right(XYf6f, Len(XYf6f) - iZBf6f))
		
		TracePrint Xf6f &" | "& Yf6f
		
	Loop Until Xf5f <> - 1  or Xf6f <> - 1 //直到成功或失败
	
	//MsgBox "PASS"
	
	Rem Exinner
	Delay 2000
	If Xf5f <> - 1  Then //如果失败
		//MsgBox "Failed"
		//Call Plugin.Bkgnd.LeftClick(HD2, 906, 1022)//点击战斗失败继续
		时空迷雾战斗 = -1
	End If
	If Xf6f <> - 1  Then //如果成功 
		//MsgBox "Succeed"
		时空迷雾战斗 = 1
	End If

End Function

